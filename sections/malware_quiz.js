// ============================================================================
// malware_quiz.js - Analyse Malware, Threat Hunting & Quiz SOC Analyst
// Preparation entretien SOC Analyst - Sopra Steria
// ============================================================================

const malwareData = {
  types: [
    {
      name: "Ransomware",
      description: "Logiciel malveillant qui chiffre les fichiers ou verrouille le systeme de la victime, puis exige une rancon (souvent en cryptomonnaie) pour restaurer l'acces. Les ransomwares modernes pratiquent la double extorsion : chiffrement + exfiltration de donnees avec menace de publication.",
      examples: "WannaCry, Petya/NotPetya, LockBit, REvil/Sodinokibi, Conti, BlackCat (ALPHV), Ryuk, Maze, Cl0p",
      indicators: [
        "Extensions de fichiers modifiees (.locked, .encrypted, .crypt)",
        "Note de rancon deposee (README.txt, DECRYPT_FILES.html)",
        "Suppression des shadow copies (vssadmin delete shadows /all)",
        "Activite reseau vers des serveurs C2 ou Tor",
        "Chiffrement massif de fichiers en peu de temps",
        "Utilisation de processus legitimes detournes (rundll32, mshta)",
        "Desactivation de Windows Defender ou d'autres AV",
        "Evenement Sysmon Event 11 (FileCreate) massif"
      ],
      detection: "Surveiller les modifications massives de fichiers (Sysmon Event 11), la suppression de shadow copies (EventCode 4688 avec vssadmin), les connexions reseau suspectes vers Tor ou des IP inconnues, et les tentatives de desactivation de l'antivirus. En Splunk : index=main sourcetype=WinEventLog EventCode=4688 CommandLine=*vssadmin* OR CommandLine=*shadow* | stats count by host, CommandLine"
    },
    {
      name: "Trojan (Cheval de Troie)",
      description: "Logiciel malveillant deguise en programme legitime. Contrairement aux virus, le trojan ne se replique pas. Il sert souvent de vecteur initial pour deployer d'autres malwares (loader/dropper) ou pour etablir un acces persistant au systeme compromis.",
      examples: "Emotet, TrickBot, QBot/QakBot, IcedID, Dridex, Agent Tesla, FormBook, BankBot",
      indicators: [
        "Processus deguise avec un nom proche d'un processus legitime (svchost vs svch0st)",
        "Execution depuis un repertoire inhabituel (AppData, Temp, Downloads)",
        "Communication reseau vers des domaines suspects ou des IP geolocalises dans des pays inhabituels",
        "Creation de cles de registre pour la persistance (Run, RunOnce)",
        "Telechargement de payloads supplementaires",
        "Injection de code dans des processus legitimes",
        "Fichier signe avec un certificat invalide ou expire"
      ],
      detection: "Verifier les processus dont le chemin d'execution est inhabituel, les connexions reseau sortantes vers des domaines recents (DGA), la creation de cles de registre de persistance. En Splunk : index=sysmon EventCode=1 (Image=*\\\\AppData\\\\* OR Image=*\\\\Temp\\\\*) | stats count by Image, ParentImage, CommandLine"
    },
    {
      name: "Rootkit",
      description: "Ensemble d'outils concu pour masquer la presence d'un attaquant sur un systeme. Le rootkit opere au niveau du noyau (kernel) ou de l'espace utilisateur pour cacher des fichiers, des processus, des connexions reseau et des cles de registre. Tres difficile a detecter avec des outils standards.",
      examples: "ZeroAccess, Necurs, Azazel, Horse Pill, Zacinlo, Scranos, LoJax (rootkit UEFI)",
      indicators: [
        "Differences entre les resultats des outils systeme et des outils forensiques",
        "Processus caches non visibles dans le Gestionnaire de taches",
        "Drivers systeme inconnus ou non signes charges au demarrage",
        "Hooks sur les appels systeme (SSDT hooking)",
        "Modifications du MBR ou du firmware UEFI",
        "Trafic reseau non attributable a un processus visible",
        "Anomalies dans les reponses des API systeme"
      ],
      detection: "Utiliser des outils de detection specialises comme GMER, RootkitRevealer, ou chkrootkit (Linux). Comparer les listes de processus obtenues par differentes methodes (API vs acces direct au noyau). Verifier l'integrite du MBR et des drivers charges. Analyse memoire avec Volatility (plugin malfind, psxview)."
    },
    {
      name: "Worm (Ver)",
      description: "Logiciel malveillant capable de se propager automatiquement d'un systeme a un autre sans interaction utilisateur, en exploitant des vulnerabilites reseau, des partages de fichiers ou des protocoles de communication. Peut causer des degats massifs par saturation du reseau.",
      examples: "WannaCry (aussi ransomware), Conficker, Slammer, Stuxnet, Blaster, Morris Worm, Emotet (capacites de ver)",
      indicators: [
        "Augmentation soudaine du trafic reseau (scans de ports massifs)",
        "Tentatives de connexion vers de nombreuses adresses IP internes (mouvement lateral)",
        "Exploitation de vulnerabilites connues (EternalBlue - MS17-010 pour SMB)",
        "Meme fichier malveillant apparu sur plusieurs machines simultanement",
        "Activite SMB ou RPC anormale",
        "Pic d'utilisation CPU/memoire sur plusieurs machines",
        "Creation de services ou taches planifiees identiques sur plusieurs hotes"
      ],
      detection: "Surveiller les scans de ports internes, le trafic SMB inhabituel, et la propagation de fichiers identiques. En Splunk : index=firewall action=allowed dest_port=445 | stats dc(dest_ip) as targets by src_ip | where targets > 20 | sort -targets"
    },
    {
      name: "Spyware / Keylogger",
      description: "Logiciel espion qui collecte des informations sur l'utilisateur a son insu : frappes clavier (keylogger), captures d'ecran, historique de navigation, identifiants, donnees bancaires. Souvent distribue via des logiciels gratuits ou des pieces jointes malveillantes.",
      examples: "Agent Tesla, FinFisher/FinSpy, Pegasus (NSO Group), HawkEye, Snake Keylogger, RedLine Stealer, Raccoon Stealer",
      indicators: [
        "Processus accedant aux API de capture clavier (SetWindowsHookEx, GetAsyncKeyState)",
        "Captures d'ecran periodiques sauvegardees localement",
        "Exfiltration de donnees par email (SMTP), FTP ou HTTP POST",
        "Acces aux fichiers de credentials des navigateurs (Login Data de Chrome)",
        "Acces au presse-papiers de maniere repetitive",
        "Connexions SMTP sortantes depuis des processus non-mail",
        "Lecture des cookies et tokens de session"
      ],
      detection: "Surveiller les appels API suspects (hook clavier), les connexions SMTP sortantes inhabituelles, l'acces aux fichiers de credentials des navigateurs. En Splunk : index=sysmon EventCode=1 CommandLine=*GetAsyncKeyState* OR CommandLine=*SetWindowsHookEx* | table _time, host, Image, CommandLine"
    },
    {
      name: "Fileless Malware (Malware sans fichier)",
      description: "Malware qui opere entierement en memoire sans ecrire de fichiers sur le disque, exploitant des outils systeme legitimes (PowerShell, WMI, .NET, macros Office). Technique dite 'Living off the Land' (LotL). Extremement difficile a detecter par les antivirus traditionnels bases sur les signatures de fichiers.",
      examples: "PowerShell Empire, Cobalt Strike (beacon en memoire), Astaroth, Kovter, GoldMax, SolarWinds SUNBURST (composantes fileless)",
      indicators: [
        "Execution PowerShell avec encodage Base64 (-EncodedCommand, -enc)",
        "Utilisation intensive de WMI (wmiprvse.exe) pour l'execution",
        "Scripts charges directement en memoire via reflection (System.Reflection.Assembly)",
        "Processus Office (Word, Excel) lancant des processus enfants suspects (cmd, powershell, mshta)",
        "Utilisation de mshta.exe, regsvr32.exe, rundll32.exe pour executer du code",
        "Chargement de DLL en memoire sans fichier sur disque (reflective DLL injection)",
        "Evenements WMI persistants (EventSubscription)"
      ],
      detection: "Activer le logging PowerShell avance (ScriptBlock Logging Event 4104, Module Logging). Surveiller les processus parents-enfants inhabituels. En Splunk : index=wineventlog sourcetype=WinEventLog:Microsoft-Windows-PowerShell/Operational EventCode=4104 ScriptBlockText=*FromBase64String* OR ScriptBlockText=*DownloadString* OR ScriptBlockText=*IEX* | table _time, host, ScriptBlockText"
    },
    {
      name: "RAT (Remote Access Trojan)",
      description: "Trojan specialise permettant a un attaquant de prendre le controle total d'une machine a distance : execution de commandes, transfert de fichiers, capture d'ecran, activation webcam/microphone, keylogging. Communique avec un serveur Command & Control (C2) pour recevoir des instructions.",
      examples: "Cobalt Strike (Beacon), Meterpreter (Metasploit), NjRAT, DarkComet, Quasar RAT, AsyncRAT, Remcos, PoisonIvy, Brute Ratel C4",
      indicators: [
        "Beaconing : connexions reseau periodiques et regulieres vers une meme IP/domaine (intervalles fixes avec jitter)",
        "Communication chiffree sur des ports inhabituels (HTTPS sur port 8443, DNS sur port 53 avec payload)",
        "Processus etablissant des connexions sortantes persistantes",
        "Creation de reverse shell (cmd.exe ou powershell.exe avec connexion reseau)",
        "Injection de code dans des processus legitimes (svchost, explorer)",
        "Utilisation de named pipes pour la communication inter-processus",
        "Trafic DNS excessif ou avec des sous-domaines anormalement longs (DNS tunneling)"
      ],
      detection: "Detecter le beaconing via l'analyse des intervalles de connexion. En Splunk : index=proxy OR index=firewall | stats count, avg(interval) as avg_int, stdev(interval) as std_int by src_ip, dest_ip | eval jitter_ratio=std_int/avg_int | where jitter_ratio < 0.1 AND count > 50. Surveiller aussi les named pipes inhabituels et les connexions DNS suspectes."
    },
    {
      name: "Cryptominer (Minage de cryptomonnaie)",
      description: "Malware qui utilise les ressources CPU/GPU de la victime pour miner de la cryptomonnaie (souvent Monero via XMRig) au profit de l'attaquant. Peut etre deploye via des vulnerabilites, du phishing, ou du cryptojacking (scripts web). Impact principal : degradation des performances et surcout energetique.",
      examples: "XMRig, CoinHive (web mining), LemonDuck, WannaMine, Kinsing, TeamTNT, Norman",
      indicators: [
        "Utilisation CPU/GPU anormalement elevee et constante (80-100%)",
        "Connexions vers des pools de minage connus (pool.minexmr.com, xmr.pool.minergate.com)",
        "Processus consommant des ressources excessives avec des noms generiques",
        "Utilisation du protocole Stratum (stratum+tcp://)",
        "Trafic reseau sur les ports standards de minage (3333, 4444, 5555, 14444)",
        "Ralentissement systeme sans cause apparente",
        "Presence de fichiers de configuration JSON avec des adresses de wallet"
      ],
      detection: "Surveiller l'utilisation CPU elevee et les connexions vers les pools de minage. En Splunk : index=proxy dest=*pool* OR dest=*miner* OR dest=*xmr* | stats count by src_ip, dest | sort -count. Aussi : index=sysmon EventCode=3 DestinationPort IN (3333, 4444, 5555, 14444) | stats count by Image, DestinationIp, DestinationPort"
    }
  ],

  analysisMethodology: {
    static: {
      description: "Analyse du malware sans l'executer. Examen du code, des metadonnees, des chaines de caracteres, de la structure du fichier et des signatures. Methode sure car le malware n'est pas active, mais limitee si le code est obfusque ou packe.",
      tools: ["strings", "PEStudio", "YARA", "VirusTotal", "Ghidra", "IDA Pro", "PEiD", "Detect It Easy (DIE)", "CFF Explorer", "Capa (MITRE)", "ssdeep (fuzzy hashing)", "FLOSS (FireEye Labs Obfuscated String Solver)"],
      steps: [
        "1. Calcul des hashs (MD5, SHA1, SHA256) pour identification unique",
        "2. Verification sur VirusTotal et autres plateformes de reputation",
        "3. Extraction des chaines de caracteres avec 'strings' ou FLOSS",
        "4. Analyse des headers PE (imports, exports, sections, entropie)",
        "5. Detection du packer/obfuscation avec PEiD ou Detect It Easy",
        "6. Analyse des imports API pour deviner le comportement (CreateRemoteThread = injection)",
        "7. Application de regles YARA pour identifier des familles connues",
        "8. Desassemblage avec Ghidra ou IDA Pro si necessaire",
        "9. Verification du certificat de signature numerique",
        "10. Analyse avec Capa pour mapper les capacites aux techniques MITRE ATT&CK"
      ]
    },
    dynamic: {
      description: "Analyse du malware en l'executant dans un environnement controle (sandbox) pour observer son comportement reel : fichiers crees/modifies, connexions reseau, modifications du registre, processus lances. Complementaire a l'analyse statique, particulierement utile contre les malwares obfusques.",
      tools: ["Any.run", "Joe Sandbox", "Cuckoo Sandbox", "Process Monitor (ProcMon)", "Wireshark", "Process Explorer", "Regshot", "API Monitor", "Fiddler/Burp Suite", "FakeNet-NG", "INetSim", "TCPView"],
      steps: [
        "1. Preparer un environnement isole (VM snapshot, reseau dedie, pas d'acces au reseau de production)",
        "2. Prendre un snapshot de l'etat initial du systeme (registre, fichiers, processus)",
        "3. Configurer les outils de capture (ProcMon, Wireshark, Regshot)",
        "4. Executer le malware dans la sandbox",
        "5. Observer les processus crees et leurs relations parent-enfant",
        "6. Capturer le trafic reseau (DNS, HTTP, C2 communication)",
        "7. Identifier les fichiers crees, modifies ou supprimes",
        "8. Documenter les modifications du registre (persistance, configuration)",
        "9. Analyser les mecanismes de persistance (services, taches planifiees, Run keys)",
        "10. Correler les observations avec la matrice MITRE ATT&CK",
        "11. Extraire les IOC (IP, domaines, hashs, artefacts) pour enrichir la detection"
      ]
    }
  },

  ioc: {
    description: "Les Indicators of Compromise (IoC) sont des preuves techniques qu'une compromission a eu lieu. Ce sont des artefacts observables qui indiquent une activite malveillante passee ou en cours. Ils sont reactifs : on les trouve apres qu'une attaque a ete detectee.",
    types: [
      {
        type: "Reseau",
        examples: [
          "Adresse IP malveillante contactee (C2 server)",
          "Domaine de Command & Control (C2)",
          "URL de phishing ou de distribution de malware",
          "User-Agent suspect ou inhabituel dans les requetes HTTP",
          "Certificat TLS auto-signe ou invalide",
          "Requetes DNS vers des domaines DGA (Domain Generation Algorithm)",
          "Trafic sur des ports non standards pour le protocole utilise"
        ]
      },
      {
        type: "Fichier",
        examples: [
          "Hash MD5/SHA1/SHA256 du fichier malveillant",
          "Nom de fichier suspect (facture.pdf.exe, update.ps1)",
          "Chemin d'acces inhabituel (C:\\Users\\Public, %TEMP%, %APPDATA%)",
          "Taille de fichier anormale ou entropie elevee (fichier packe)",
          "Fichier avec double extension ou icone trompeuse",
          "DLL placee dans un repertoire systeme sans signature valide",
          "Fichier de configuration du malware (souvent JSON ou XML)"
        ]
      },
      {
        type: "Systeme",
        examples: [
          "Cle de registre de persistance ajoutee (HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run)",
          "Service Windows cree avec un nom generique ou aleatoire",
          "Tache planifiee suspecte (schtasks)",
          "Processus avec un nom imitant un processus legitime (scvhost.exe vs svchost.exe)",
          "Injection de DLL dans un processus systeme",
          "Compte utilisateur cree par l'attaquant",
          "Modification des permissions ou des politiques de securite"
        ]
      },
      {
        type: "Email",
        examples: [
          "Adresse expediteur usurpee ou suspecte (spoofing)",
          "Objet de mail typique de phishing (Facture urgente, Mise a jour requise)",
          "Piece jointe malveillante (macro Word/Excel, PDF piege, archive protegee par mot de passe)",
          "Lien vers un domaine lookalike (typosquatting)",
          "En-tetes email modifies (X-Originating-IP, Return-Path)",
          "Defaut SPF/DKIM/DMARC dans les en-tetes"
        ]
      }
    ]
  },

  ioa: {
    description: "Les Indicators of Attack (IoA) sont des indicateurs comportementaux qui revelent une attaque en cours, independamment des outils utilises. Contrairement aux IoC (reactifs et bases sur des signatures), les IoA sont proactifs et se concentrent sur les intentions et les methodes de l'attaquant. Ils sont plus difficiles a contourner car meme si l'attaquant change ses outils, les comportements restent similaires.",
    examples: [
      "Processus enfant inhabituel : Word ou Excel lance PowerShell, cmd.exe ou mshta.exe (indicateur de macro malveillante)",
      "Connexion reseau sortante depuis un processus qui n'est pas cense communiquer (notepad.exe, calc.exe)",
      "Acces massif a des fichiers en peu de temps (possible ransomware ou exfiltration)",
      "Elevation de privileges suivie de mouvement lateral (ex: Mimikatz puis PsExec)",
      "Execution de commandes de reconnaissance (whoami, net user, ipconfig, nltest) en sequence rapide",
      "Processus systeme lance depuis un chemin inhabituel (svchost.exe en dehors de System32)",
      "Desactivation de l'antivirus ou du logging suivie d'activite suspecte",
      "Multiple echecs de connexion suivis d'une reussite (brute force)",
      "Creation de compte suivi immediatement d'un ajout au groupe Administrateurs",
      "Connexion a distance (RDP, SSH) depuis une IP jamais vue auparavant, en dehors des heures de travail",
      "Utilisation de LOLBins (certutil, bitsadmin, mshta) pour telecharger des payloads",
      "Communication DNS avec des sous-domaines extremement longs ou entropie elevee (DNS tunneling)"
    ]
  },

  threatHunting: {
    description: "Le Threat Hunting est une approche proactive de recherche de menaces qui n'ont pas ete detectees par les outils de securite automatises. Le hunter formule des hypotheses basees sur les renseignements sur les menaces (Threat Intelligence), les techniques ATT&CK, et la connaissance de l'environnement, puis cherche activement des preuves dans les donnees.",
    methodologies: [
      {
        name: "Hypothesis-Driven (Base sur les hypotheses)",
        description: "Le chasseur formule une hypothese sur une menace potentielle basee sur le renseignement (Threat Intelligence), les tendances d'attaque recentes, ou les vulnerabilites de l'environnement. Il teste ensuite cette hypothese en analysant les donnees disponibles.",
        steps: [
          "1. Formuler une hypothese precise basee sur la Threat Intelligence ou le contexte",
          "2. Identifier les sources de donnees necessaires (logs, SIEM, EDR)",
          "3. Developper les requetes et les methodes d'investigation",
          "4. Executer les requetes et analyser les resultats",
          "5. Confirmer ou infirmer l'hypothese",
          "6. Documenter les trouvailles et ameliorer les detections",
          "7. Creer des regles de detection automatisees si la menace est confirmee"
        ]
      },
      {
        name: "IOC-Based (Base sur les indicateurs)",
        description: "Recherche basee sur des indicateurs de compromission connus (hashs, IP, domaines) provenant de feeds de Threat Intelligence, de rapports d'incidents, ou de partage communautaire (MISP, OTX). Approche reactive mais efficace pour verifier l'exposition a des menaces connues.",
        steps: [
          "1. Collecter les IOC depuis les feeds TI (MISP, AlienVault OTX, VirusTotal, CERT-FR)",
          "2. Normaliser et enrichir les IOC (contexte, criticite, date de validite)",
          "3. Charger les IOC dans le SIEM via des lookup tables",
          "4. Rechercher les correspondances dans les logs historiques (retrohunt)",
          "5. Investiguer les matchs pour determiner la portee de la compromission",
          "6. Pivoter sur les resultats pour decouvrir d'autres artefacts lies",
          "7. Mettre a jour les regles de detection en consequence"
        ]
      },
      {
        name: "Baseline/Anomaly (Base sur les anomalies)",
        description: "Etablir une ligne de base du comportement normal de l'environnement, puis rechercher les deviations significatives. Cette methode est efficace contre les menaces inconnues (zero-day) car elle ne depend pas de signatures ou d'IOC connus.",
        steps: [
          "1. Definir ce qui constitue le 'normal' dans l'environnement (baseline)",
          "2. Collecter des donnees sur une periode representative",
          "3. Identifier les metriques cles (nombre de connexions, volume de donnees, processus habituels)",
          "4. Appliquer des methodes statistiques ou du machine learning pour detecter les anomalies",
          "5. Investiguer les deviations significatives",
          "6. Distinguer les faux positifs des vraies menaces",
          "7. Affiner la baseline et les seuils de detection"
        ]
      }
    ],
    huntExamples: [
      {
        hypothesis: "Un attaquant utilise PowerShell pour etablir une communication C2 via des commandes encodees en Base64",
        dataSources: "Sysmon Event 1 (Process Create), PowerShell ScriptBlock Logging (Event 4104), Windows Security Log",
        query: 'index=wineventlog sourcetype="WinEventLog:Microsoft-Windows-PowerShell/Operational" EventCode=4104 (ScriptBlockText=*FromBase64String* OR ScriptBlockText=*EncodedCommand* OR ScriptBlockText=*DownloadString* OR ScriptBlockText=*IEX* OR ScriptBlockText=*Invoke-Expression* OR ScriptBlockText=*Net.WebClient* OR ScriptBlockText=*Start-BitsTransfer*) | stats count by host, ScriptBlockText | sort -count',
        expected: "Detection de scripts PowerShell malveillants telechargeant des payloads ou executant du code encode. Les resultats legitimes (scripts d'administration) doivent etre filtres par une whitelist de scripts connus."
      },
      {
        hypothesis: "Un attaquant exfiltre des donnees via le protocole DNS en utilisant des sous-domaines anormalement longs (DNS tunneling)",
        dataSources: "DNS logs, Sysmon Event 22 (DNS Query), logs du serveur DNS interne, logs proxy",
        query: 'index=dns | eval subdomain_length=len(query) | where subdomain_length > 50 | stats count, avg(subdomain_length) as avg_len, dc(query) as unique_queries by src_ip, query_type | where unique_queries > 100 | sort -unique_queries',
        expected: "Identification de machines generant un volume anormalement eleve de requetes DNS longues. Un trafic DNS legitime a rarement des sous-domaines depassant 50 caracteres. Les outils comme iodine, dnscat2, ou Cobalt Strike DNS utilisent cette technique."
      },
      {
        hypothesis: "Un attaquant effectue un mouvement lateral via PsExec ou des outils similaires utilisant les partages administratifs (ADMIN$, C$)",
        dataSources: "Windows Security Logs (4624 type 3, 4648, 7045), Sysmon Event 1, Event 17 (Pipe Created)",
        query: 'index=wineventlog (EventCode=7045 ServiceName="PSEXESVC") OR (EventCode=1 (Image=*psexec* OR Image=*paexec*)) OR (EventCode=5145 ShareName="\\\\*\\ADMIN$") OR (EventCode=17 PipeName=*PSEXE*) | stats count, values(ServiceName) as services, values(Image) as images by host, src_ip | sort -count',
        expected: "Detection de l'utilisation de PsExec ou d'outils similaires pour l'execution a distance. Verifier si l'activite correspond a des operations d'administration legitimes ou a un mouvement lateral malveillant. Pivoter sur les comptes utilises et les machines cibles."
      },
      {
        hypothesis: "Un attaquant utilise des techniques de credential dumping (Mimikatz, lsass dump) pour voler des identifiants",
        dataSources: "Sysmon Event 10 (Process Access), Windows Security (4656, 4663), Event 1",
        query: 'index=sysmon EventCode=10 TargetImage=*lsass.exe GrantedAccess IN ("0x1010", "0x1410", "0x1438", "0x143a", "0x1fffff") | stats count by SourceImage, GrantedAccess, host | where SourceImage!="*csrss.exe" AND SourceImage!="*wininit.exe" AND SourceImage!="*wmiprvse.exe"',
        expected: "Detection de processus accedant a lsass.exe avec des droits elevees. Les acces legitimes proviennent de processus systeme connus. Tout autre acces est hautement suspect et peut indiquer Mimikatz, ProcDump, ou Task Manager utilise pour dumper la memoire de lsass."
      },
      {
        hypothesis: "Un attaquant utilise des taches planifiees pour maintenir la persistance sur des systemes compromis",
        dataSources: "Windows Security (4698 - Task Created, 4702 - Task Updated), Sysmon Event 1",
        query: 'index=wineventlog EventCode=4698 | spath TaskContent | search TaskContent=*powershell* OR TaskContent=*cmd* OR TaskContent=*mshta* OR TaskContent=*rundll32* OR TaskContent=*regsvr32* OR TaskContent=*wscript* OR TaskContent=*cscript* | table _time, host, TaskName, TaskContent | sort -_time',
        expected: "Identification de taches planifiees executant des outils suspects comme PowerShell, cmd ou des LOLBins. Les taches legitimes sont generalement documentees et proviennent d'installations logicielles connues."
      }
    ]
  },

  yaraBasics: {
    description: "YARA est un outil de detection et de classification de malwares base sur des regles textuelles. Chaque regle definit des chaines de caracteres (strings) et des conditions logiques pour identifier des fichiers malveillants. Utilise par les analystes SOC, les chercheurs en malware et les outils de securite (ClamAV, VirusTotal, THOR).",
    exampleRule: `rule Detect_Mimikatz_Strings {
    meta:
        description = "Detecte les chaines caracteristiques de Mimikatz"
        author = "SOC Analyst"
        severity = "high"
        reference = "https://attack.mitre.org/software/S0002/"
    strings:
        $s1 = "mimikatz" ascii wide nocase
        $s2 = "sekurlsa" ascii wide
        $s3 = "kerberos::list" ascii wide
        $s4 = "privilege::debug" ascii wide
        $s5 = "lsadump::sam" ascii wide
        $s6 = "sekurlsa::logonpasswords" ascii wide
    condition:
        uint16(0) == 0x5A4D and (3 of ($s*))
}`,
    keyPoints: [
      "Les regles YARA sont composees de 3 sections : meta (metadonnees), strings (chaines a rechercher), condition (logique de detection)",
      "Les modificateurs ascii, wide (UTF-16), nocase permettent d'elargir la detection",
      "uint16(0) == 0x5A4D verifie que le fichier est un executable PE (MZ header)",
      "Les operateurs logiques : and, or, not, any of, all of, X of",
      "Les regles peuvent utiliser des expressions regulieres : $regex = /pattern/",
      "La condition 'filesize < 500KB' permet de limiter la taille des fichiers analyses",
      "YARA peut scanner des fichiers, des processus en memoire, et des flux reseau",
      "Les regles YARA communautaires sont disponibles sur https://github.com/Yara-Rules/rules",
      "L'outil yarGen genere automatiquement des regles YARA a partir d'echantillons de malware",
      "Integrer YARA avec Splunk via des lookup ou des commandes personnalisees pour enrichir les alertes"
    ]
  }
};

// ============================================================================
// QUIZ DATA - Questions d'entrainement par categorie
// ============================================================================

const quizData = {
  // =========================================================================
  // SPLUNK - Architecture, SPL, Concepts
  // =========================================================================
  splunk: [
    {
      q: "Quelle commande SPL permet de compter les evenements par champ ?",
      options: ["stats count by field", "count field", "group by field", "aggregate count field"],
      correct: 0,
      explanation: "La commande 'stats count by field' est la syntaxe correcte pour agreger et compter les evenements groupes par un champ specifique."
    },
    {
      q: "Quel est le role d'un Universal Forwarder dans l'architecture Splunk ?",
      options: ["Indexer les donnees", "Collecter et envoyer les logs aux indexers", "Chercher dans les donnees", "Gerer les licences"],
      correct: 1,
      explanation: "Le Universal Forwarder (UF) est un agent leger installe sur les endpoints qui collecte les logs et les transmet aux indexers. Il ne fait pas d'indexation ni de recherche."
    },
    {
      q: "Quelle commande SPL permet de creer un graphique temporel ?",
      options: ["chart over time", "timechart", "timeline", "temporal count"],
      correct: 1,
      explanation: "La commande 'timechart' cree un graphique avec le temps en axe X. Par exemple : timechart count by sourcetype span=1h."
    },
    {
      q: "Que fait la commande 'eval' en SPL ?",
      options: ["Evalue la performance d'une requete", "Cree ou modifie des champs avec des expressions calculees", "Evalue la qualite des donnees", "Calcule les statistiques automatiquement"],
      correct: 1,
      explanation: "La commande 'eval' permet de creer de nouveaux champs ou de modifier des champs existants avec des expressions calculees. Ex: | eval severity=if(count>100, \"high\", \"low\")"
    },
    {
      q: "Quel composant Splunk est responsable du stockage des donnees ?",
      options: ["Search Head", "Deployment Server", "Indexer", "Heavy Forwarder"],
      correct: 2,
      explanation: "L'Indexer recoit les donnees des forwarders, les indexe, les stocke dans des buckets et les rend recherchables. C'est le composant central du stockage."
    },
    {
      q: "Quelle commande SPL permet de joindre deux ensembles de donnees ?",
      options: ["merge", "combine", "join", "append"],
      correct: 2,
      explanation: "La commande 'join' combine les resultats de deux recherches sur un champ commun. Attention : Splunk recommande d'utiliser 'stats' ou 'lookup' plutot que 'join' pour de meilleures performances."
    },
    {
      q: "Quelle est la difference entre 'where' et 'search' en SPL ?",
      options: [
        "'where' evalue des expressions, 'search' utilise la syntaxe de recherche Splunk",
        "Il n'y a pas de difference",
        "'search' est plus rapide",
        "'where' fonctionne uniquement sur les nombres"
      ],
      correct: 0,
      explanation: "'where' utilise des expressions booleennes et est sensible a la casse. 'search' utilise la syntaxe de recherche Splunk standard et est insensible a la casse. 'where' traite les valeurs non existantes comme null."
    },
    {
      q: "Que fait la commande 'lookup' en Splunk ?",
      options: ["Recherche dans les index", "Enrichit les donnees avec une table de reference externe (CSV, KV Store)", "Recherche des utilisateurs", "Verifie la configuration"],
      correct: 1,
      explanation: "La commande 'lookup' permet d'enrichir les resultats de recherche avec des donnees provenant d'une source externe (fichier CSV ou KV Store). Ex: | lookup threat_intel ip as src_ip OUTPUT threat_type."
    },
    {
      q: "Quel port est utilise par defaut par un Splunk Forwarder pour envoyer des donnees a un Indexer ?",
      options: ["8000", "8089", "9997", "514"],
      correct: 2,
      explanation: "Le port 9997 est le port par defaut pour la reception de donnees depuis les forwarders (receiving port). Le port 8089 est le port de management, et 8000 est le port web."
    },
    {
      q: "Quelle commande SPL utilise-t-on pour renommer un champ ?",
      options: ["rename", "alias", "as", "label"],
      correct: 0,
      explanation: "La commande 'rename' change le nom d'un champ dans les resultats. Syntaxe : | rename ancien_nom as nouveau_nom. Le mot-cle 'as' est un operateur utilise dans la syntaxe mais pas une commande."
    },
    {
      q: "Que sont les 'buckets' dans Splunk ?",
      options: [
        "Des groupes d'utilisateurs",
        "Des conteneurs de donnees indexees organises par age (hot, warm, cold, frozen)",
        "Des categories d'alertes",
        "Des regles de parsing"
      ],
      correct: 1,
      explanation: "Les buckets sont les unites de stockage de Splunk : Hot (en cours d'ecriture), Warm (lecture seule recente), Cold (archives), Frozen (donnees archivees hors Splunk ou supprimees)."
    },
    {
      q: "Quelle commande SPL permet de supprimer les doublons ?",
      options: ["unique", "distinct", "dedup", "uniq"],
      correct: 2,
      explanation: "La commande 'dedup' supprime les evenements en doublon bases sur un ou plusieurs champs. Ex: | dedup src_ip dest_ip pour garder une seule occurrence par paire source-destination."
    },
    {
      q: "Comment creer une alerte basee sur le nombre de tentatives de connexion echouees ?",
      options: [
        "index=security EventCode=4625 | alert threshold=5",
        "index=security EventCode=4625 | stats count by user | where count > 5",
        "alert EventCode=4625 count>5",
        "search EventCode=4625 | notify if count > 5"
      ],
      correct: 1,
      explanation: "On utilise 'stats count by user' pour compter les echecs par utilisateur, puis 'where count > 5' pour filtrer. Cette requete est ensuite configuree comme une alerte planifiee avec un seuil."
    },
    {
      q: "Que fait la commande 'tstats' par rapport a 'stats' ?",
      options: [
        "C'est un alias de stats",
        "Elle effectue des recherches accelerees sur les donnees indexees (tsdix/datamodel)",
        "Elle calcule les statistiques temporelles uniquement",
        "Elle fonctionne uniquement sur les donnees en temps reel"
      ],
      correct: 1,
      explanation: "'tstats' est une version acceleree de 'stats' qui fonctionne sur les index acceleres (tsidx) et les Data Models. Elle est beaucoup plus rapide car elle n'a pas besoin de scanner les evenements bruts."
    },
    {
      q: "Quelle commande SPL permet de transformer des valeurs de lignes en colonnes ?",
      options: ["pivot", "transpose", "xyseries", "chart"],
      correct: 2,
      explanation: "'xyseries' transforme les resultats en format tabulaire avec les valeurs d'un champ comme en-tetes de colonnes. Utile pour creer des tableaux croises. 'transpose' inverse lignes et colonnes d'un tableau existant."
    },
    {
      q: "Quelle est la fonction de 'rex' en SPL ?",
      options: [
        "Execution d'expressions regulieres pour extraire des champs a partir du texte brut",
        "Rexecution d'une requete precedente",
        "Gestion des references croisees",
        "Envoi de resultats par email"
      ],
      correct: 0,
      explanation: "'rex' utilise les expressions regulieres pour extraire des champs des evenements. Ex: | rex field=_raw \"user=(?<username>\\w+)\" extrait le nom d'utilisateur dans un nouveau champ."
    },
    {
      q: "Quel role joue le Search Head Cluster dans une architecture Splunk ?",
      options: [
        "Stockage distribue des donnees",
        "Haute disponibilite et equilibrage de charge pour les recherches",
        "Collection des logs en cluster",
        "Gestion centralisee des licences"
      ],
      correct: 1,
      explanation: "Le Search Head Cluster (SHC) regroupe plusieurs Search Heads pour assurer la haute disponibilite, la repartition des recherches et le partage des artefacts de connaissance (dashboards, alertes, rapports)."
    },
    {
      q: "Quelle commande SPL permet de calculer des valeurs cumulees dans le temps ?",
      options: ["cumulate", "streamstats", "running_total", "accum"],
      correct: 1,
      explanation: "'streamstats' calcule des statistiques cumulatives a mesure que les evenements sont traites. Ex: | streamstats count as running_count permet de voir l'evolution cumulative."
    },
    {
      q: "Que signifie le 'sourcetype' dans Splunk ?",
      options: [
        "L'adresse IP source",
        "Le format ou le type de donnees (categorie du log)",
        "Le serveur qui a envoye les donnees",
        "Le chemin du fichier source"
      ],
      correct: 1,
      explanation: "Le sourcetype definit le format des donnees pour que Splunk sache comment les parser. Exemples : WinEventLog:Security, syslog, access_combined. Il determine la structure et l'extraction des champs."
    },
    {
      q: "Quelle commande SPL est la plus efficace pour identifier les valeurs les plus frequentes d'un champ ?",
      options: ["stats count by", "top", "rare", "frequent"],
      correct: 1,
      explanation: "'top' retourne les N valeurs les plus frequentes d'un champ avec leur count et pourcentage. Ex: | top 10 src_ip. C'est un raccourci pour '| stats count by field | sort -count | head 10'."
    },
    {
      q: "Comment definir une macro de recherche en Splunk ?",
      options: [
        "Via Settings > Advanced Search > Search Macros",
        "En creant un fichier .macro dans etc/apps",
        "Via la commande | macro define",
        "Dans le fichier transforms.conf"
      ],
      correct: 0,
      explanation: "Les macros de recherche se configurent dans Settings > Advanced Search > Search Macros (ou dans macros.conf). Elles permettent de reutiliser des segments SPL complexes avec la syntaxe `nom_macro`."
    },
    {
      q: "Que fait la commande 'table' en SPL ?",
      options: [
        "Cree une table dans la base de donnees",
        "Affiche uniquement les champs specifies sous forme de tableau",
        "Convertit les resultats en CSV",
        "Regroupe les resultats par table"
      ],
      correct: 1,
      explanation: "'table' filtre et ordonne les champs affiches dans les resultats. Ex: | table _time, src_ip, dest_ip, action affiche uniquement ces 4 champs dans cet ordre."
    },
    {
      q: "Quelle est la difference entre un Heavy Forwarder et un Universal Forwarder ?",
      options: [
        "Il n'y a pas de difference",
        "Le HF peut parser et filtrer les donnees avant de les envoyer, le UF envoie les donnees brutes",
        "Le UF est plus puissant que le HF",
        "Le HF est uniquement pour Linux"
      ],
      correct: 1,
      explanation: "Le Heavy Forwarder (HF) possede les capacites de parsing et de filtrage de Splunk. Il peut transformer les donnees avant de les envoyer aux indexers. Le Universal Forwarder (UF) est un agent leger qui transmet les donnees brutes."
    }
  ],

  // =========================================================================
  // MITRE ATT&CK - Framework, Tactiques, Techniques
  // =========================================================================
  mitre: [
    {
      q: "Combien de tactiques contient la matrice MITRE ATT&CK Enterprise ?",
      options: ["10", "12", "14", "16"],
      correct: 2,
      explanation: "La matrice Enterprise contient 14 tactiques : Reconnaissance, Resource Development, Initial Access, Execution, Persistence, Privilege Escalation, Defense Evasion, Credential Access, Discovery, Lateral Movement, Collection, Command and Control, Exfiltration, Impact."
    },
    {
      q: "Quelle tactique correspond a l'utilisation de Mimikatz pour extraire des credentials ?",
      options: ["Execution", "Credential Access", "Lateral Movement", "Discovery"],
      correct: 1,
      explanation: "Mimikatz est un outil de Credential Access (TA0006), principalement la technique OS Credential Dumping (T1003) et ses sous-techniques (LSASS Memory T1003.001, SAM T1003.002, DCSync T1003.006)."
    },
    {
      q: "Quelle est la difference entre une tactique et une technique dans MITRE ATT&CK ?",
      options: [
        "Il n'y a pas de difference",
        "La tactique est le 'pourquoi' (objectif), la technique est le 'comment' (methode)",
        "La technique est plus importante que la tactique",
        "La tactique est specifique, la technique est generale"
      ],
      correct: 1,
      explanation: "La tactique represente l'objectif de l'attaquant (pourquoi il fait quelque chose), par exemple 'Persistence'. La technique decrit comment il atteint cet objectif, par exemple 'Registry Run Keys' (T1547.001)."
    },
    {
      q: "Quel identifiant MITRE ATT&CK correspond au Phishing ?",
      options: ["T1059", "T1566", "T1078", "T1190"],
      correct: 1,
      explanation: "T1566 est la technique Phishing dans la tactique Initial Access. Sous-techniques : Spearphishing Attachment (T1566.001), Spearphishing Link (T1566.002), Spearphishing via Service (T1566.003)."
    },
    {
      q: "A quelle tactique appartient la technique 'Scheduled Task/Job' (T1053) ?",
      options: ["Initial Access", "Execution et Persistence", "Lateral Movement", "Collection"],
      correct: 1,
      explanation: "T1053 Scheduled Task/Job appartient a deux tactiques : Execution (executer du code) et Persistence (maintenir l'acces). De nombreuses techniques MITRE appartiennent a plusieurs tactiques."
    },
    {
      q: "Que represente la technique T1059 dans MITRE ATT&CK ?",
      options: ["Phishing", "Command and Scripting Interpreter", "Valid Accounts", "Brute Force"],
      correct: 1,
      explanation: "T1059 est 'Command and Scripting Interpreter' (Execution). Sous-techniques : PowerShell (T1059.001), Bash (T1059.004), Python (T1059.006), JavaScript (T1059.007)."
    },
    {
      q: "Quelle tactique MITRE ATT&CK est associee au mouvement lateral ?",
      options: ["TA0006", "TA0007", "TA0008", "TA0009"],
      correct: 2,
      explanation: "TA0008 est Lateral Movement. Les techniques incluent Remote Services (T1021), Exploitation of Remote Services (T1210), Internal Spearphishing (T1534)."
    },
    {
      q: "Qu'est-ce que la technique 'Living off the Land' (T1218, T1569, T1059) ?",
      options: [
        "Utiliser des outils systeme legitimes pour des activites malveillantes",
        "Se cacher dans le systeme de fichiers",
        "Utiliser des malwares zero-day",
        "Exploiter des vulnerabilites physiques"
      ],
      correct: 0,
      explanation: "Living off the Land Binaries (LOLBins) consiste a utiliser des outils Windows legitimes (PowerShell, certutil, mshta, regsvr32, bitsadmin) pour des actions malveillantes, evitant ainsi la detection par les antivirus."
    },
    {
      q: "Quelle technique MITRE decrit le chiffrement des donnees par un ransomware ?",
      options: ["T1486 - Data Encrypted for Impact", "T1005 - Data from Local System", "T1567 - Exfiltration Over Web Service", "T1490 - Inhibit System Recovery"],
      correct: 0,
      explanation: "T1486 'Data Encrypted for Impact' (Impact) decrit le chiffrement des donnees pour empecher l'acces et extorquer une rancon. T1490 'Inhibit System Recovery' est souvent utilise conjointement (suppression des shadow copies)."
    },
    {
      q: "Quelle est la premiere tactique de la Kill Chain dans MITRE ATT&CK Enterprise ?",
      options: ["Initial Access", "Reconnaissance", "Resource Development", "Execution"],
      correct: 1,
      explanation: "Reconnaissance (TA0043) est la premiere tactique. L'attaquant collecte des informations sur la cible avant toute interaction directe. Ajoutee dans ATT&CK v8, elle couvre la phase pre-attaque."
    },
    {
      q: "Qu'est-ce que le framework MITRE D3FEND ?",
      options: [
        "Une version defensive de MITRE ATT&CK qui recense les contre-mesures",
        "Un outil d'attaque",
        "Une base de donnees de vulnerabilites",
        "Un standard de chiffrement"
      ],
      correct: 0,
      explanation: "D3FEND est le complement defensif d'ATT&CK. Il recense les techniques defensives (detection, isolation, tromperie) et les mappe aux techniques d'attaque ATT&CK pour aider les defenseurs a choisir les contre-mesures appropriees."
    },
    {
      q: "Quelle technique MITRE correspond a l'utilisation de comptes valides voles ?",
      options: ["T1133", "T1078", "T1110", "T1534"],
      correct: 1,
      explanation: "T1078 'Valid Accounts' couvre l'utilisation de comptes legitimes compromis. Cette technique apparait dans plusieurs tactiques : Initial Access, Persistence, Privilege Escalation, Defense Evasion."
    },
    {
      q: "Qu'est-ce que le 'Data Source' dans MITRE ATT&CK ?",
      options: [
        "La base de donnees de MITRE",
        "Les sources de logs necessaires pour detecter une technique specifique",
        "Le code source d'un malware",
        "Les donnees volees par l'attaquant"
      ],
      correct: 1,
      explanation: "Les Data Sources dans ATT&CK indiquent quelles sources de donnees (Process Creation, Network Traffic, File Monitoring, etc.) sont necessaires pour detecter chaque technique. C'est essentiel pour planifier la couverture de detection."
    },
    {
      q: "Quelle technique MITRE decrit le Brute Force ?",
      options: ["T1003", "T1110", "T1071", "T1090"],
      correct: 1,
      explanation: "T1110 'Brute Force' (Credential Access) couvre les tentatives d'obtention d'identifiants par force brute. Sous-techniques : Password Guessing (T1110.001), Password Cracking (T1110.002), Password Spraying (T1110.003), Credential Stuffing (T1110.004)."
    },
    {
      q: "A quoi sert l'outil MITRE ATT&CK Navigator ?",
      options: [
        "A naviguer sur le web de maniere securisee",
        "A visualiser et annoter la couverture des techniques ATT&CK",
        "A scanner les vulnerabilites",
        "A generer des rapports de pentest"
      ],
      correct: 1,
      explanation: "ATT&CK Navigator est un outil web permettant de visualiser la matrice ATT&CK, d'annoter les techniques couvertes par les detections, de comparer les groupes d'attaquants, et de planifier les ameliorations de securite."
    },
    {
      q: "Quelle technique MITRE correspond a l'injection de processus ?",
      options: ["T1055", "T1053", "T1059", "T1047"],
      correct: 0,
      explanation: "T1055 'Process Injection' (Defense Evasion, Privilege Escalation). Sous-techniques : DLL Injection (T1055.001), PE Injection (T1055.002), Process Hollowing (T1055.012). Permet d'executer du code dans un processus legitime."
    },
    {
      q: "Quelle tactique MITRE couvre les techniques pour eviter la detection ?",
      options: ["TA0005 - Defense Evasion", "TA0007 - Discovery", "TA0004 - Privilege Escalation", "TA0011 - Command and Control"],
      correct: 0,
      explanation: "TA0005 Defense Evasion regroupe les techniques pour eviter la detection : obfuscation, desactivation des outils de securite, suppression de logs, masquage de fichiers, timestomping, signature de code."
    }
  ],

  // =========================================================================
  // SOC Operations - IR, Securite, Processus
  // =========================================================================
  soc: [
    {
      q: "Dans le framework NIST IR (SP 800-61), quelle est la premiere phase ?",
      options: ["Detection", "Preparation", "Confinement", "Analyse"],
      correct: 1,
      explanation: "Le NIST SP 800-61 definit 4 phases : 1) Preparation (outils, procedures, formation), 2) Detection & Analyse, 3) Confinement/Eradication/Recuperation, 4) Activite Post-Incident (lessons learned)."
    },
    {
      q: "L'EventCode Windows 4625 correspond a quel evenement ?",
      options: ["Connexion reussie", "Echec de connexion", "Compte cree", "Service installe"],
      correct: 1,
      explanation: "4625 = Failed Logon (echec de connexion). A retenir : 4624 = Successful Logon, 4625 = Failed Logon, 4634 = Logoff, 4648 = Logon with explicit credentials."
    },
    {
      q: "Qu'est-ce qu'un faux positif dans le contexte d'un SOC ?",
      options: [
        "Une alerte generee pour une activite reellement malveillante",
        "Une alerte generee pour une activite legitime identifiee a tort comme malveillante",
        "Un incident non detecte",
        "Une erreur de configuration du SIEM"
      ],
      correct: 1,
      explanation: "Un faux positif est une alerte declenchee pour une activite inoffensive. Les faux positifs sont un defi majeur des SOC car ils consomment du temps d'analyse. Un faux negatif (activite malveillante non detectee) est plus dangereux."
    },
    {
      q: "Quel est le role principal d'un SIEM ?",
      options: [
        "Bloquer les attaques en temps reel",
        "Collecter, correler et analyser les logs de securite centralises",
        "Gerer les patchs de securite",
        "Effectuer des scans de vulnerabilites"
      ],
      correct: 1,
      explanation: "Le SIEM (Security Information and Event Management) centralise les logs, les correle pour detecter les menaces, genere des alertes et fournit des tableaux de bord. Il ne bloque pas directement (role du firewall/IPS/EDR)."
    },
    {
      q: "Quelle est la difference entre un IDS et un IPS ?",
      options: [
        "L'IDS est plus recent que l'IPS",
        "L'IDS detecte et alerte, l'IPS detecte et bloque automatiquement",
        "L'IPS est un logiciel, l'IDS est un materiel",
        "Il n'y a pas de difference"
      ],
      correct: 1,
      explanation: "L'IDS (Intrusion Detection System) detecte et genere des alertes sans bloquer. L'IPS (Intrusion Prevention System) detecte ET bloque automatiquement le trafic malveillant. L'IPS est deploye en ligne (inline), l'IDS en mode ecoute (tap/span)."
    },
    {
      q: "L'EventCode Windows 4720 correspond a quel evenement ?",
      options: ["Suppression de compte", "Creation de compte utilisateur", "Modification de mot de passe", "Connexion reussie"],
      correct: 1,
      explanation: "4720 = Creation de compte utilisateur. A retenir : 4722 = Compte active, 4723 = Changement de mot de passe par l'utilisateur, 4724 = Reset de mot de passe par un admin, 4726 = Suppression de compte."
    },
    {
      q: "Quel est le but de la phase 'Lessons Learned' dans la reponse a incident ?",
      options: [
        "Punir les responsables de l'incident",
        "Analyser l'incident pour ameliorer les processus et la detection future",
        "Restaurer les systemes affectes",
        "Communiquer avec les medias"
      ],
      correct: 1,
      explanation: "La phase Post-Incident / Lessons Learned vise a documenter l'incident, identifier les ameliorations possibles (detection, procedures, formation), et partager les IOC avec la communaute. C'est essentiel pour l'amelioration continue."
    },
    {
      q: "Qu'est-ce que la Cyber Kill Chain de Lockheed Martin ?",
      options: [
        "Un outil de pentest",
        "Un modele en 7 etapes decrivant les phases d'une cyberattaque",
        "Un framework de gouvernance",
        "Un protocole de communication securise"
      ],
      correct: 1,
      explanation: "La Kill Chain comporte 7 phases : 1) Reconnaissance, 2) Weaponization, 3) Delivery, 4) Exploitation, 5) Installation, 6) Command & Control (C2), 7) Actions on Objectives. L'objectif est de detecter et interrompre l'attaque le plus tot possible."
    },
    {
      q: "Quel EventCode Windows indique l'installation d'un nouveau service ?",
      options: ["4624", "4688", "7045", "1102"],
      correct: 2,
      explanation: "EventCode 7045 (System log) indique l'installation d'un nouveau service. C'est un indicateur important de persistance. A surveiller attentivement, surtout si le chemin du binaire est inhabituel."
    },
    {
      q: "Qu'est-ce que le SOAR dans un SOC ?",
      options: [
        "Un type de firewall",
        "Security Orchestration, Automation and Response - plateforme d'automatisation",
        "Un standard de chiffrement",
        "Un framework d'audit"
      ],
      correct: 1,
      explanation: "Le SOAR (Security Orchestration, Automation and Response) automatise les processus de reponse a incident via des playbooks. Il orchestre les outils de securite (SIEM, EDR, TI) et reduit le temps de reponse (MTTR). Exemples : Palo Alto XSOAR, Splunk SOAR, IBM QRadar SOAR."
    },
    {
      q: "Quel EventCode Windows correspond a l'effacement du journal d'audit ?",
      options: ["4688", "1102", "4672", "7036"],
      correct: 1,
      explanation: "EventCode 1102 (Security log) indique que le journal d'audit de securite a ete efface. C'est un indicateur critique de Defense Evasion (T1070.001). L'EventCode 104 (System log) indique l'effacement d'autres journaux."
    },
    {
      q: "Qu'est-ce que le principe du 'moindre privilege' ?",
      options: [
        "Donner tous les acces a tous les utilisateurs",
        "Accorder uniquement les droits strictement necessaires a chaque utilisateur pour ses fonctions",
        "Retirer tous les privileges administratifs",
        "N'accorder des privileges qu'aux seniors"
      ],
      correct: 1,
      explanation: "Le principe du moindre privilege (Least Privilege) stipule que chaque utilisateur, processus ou systeme ne doit avoir que les droits minimaux necessaires a l'accomplissement de ses taches. Cela limite l'impact en cas de compromission."
    },
    {
      q: "Quel Sysmon EventCode correspond a la creation d'un processus ?",
      options: ["Event 1", "Event 3", "Event 7", "Event 11"],
      correct: 0,
      explanation: "Sysmon Event 1 = Process Create. C'est l'evenement le plus important de Sysmon car il capture le processus cree, son parent, la ligne de commande, le hash, et l'utilisateur. Essentiel pour l'analyse de la chaine de processus."
    },
    {
      q: "Qu'est-ce que le 'Triage' dans le contexte d'un SOC ?",
      options: [
        "Le processus de suppression des alertes",
        "L'evaluation rapide et la priorisation des alertes de securite",
        "La creation de rapports mensuels",
        "L'installation de correctifs de securite"
      ],
      correct: 1,
      explanation: "Le triage est le processus d'evaluation rapide des alertes pour determiner leur severite, leur legitimite (vrai/faux positif), et leur priorite de traitement. Un analyste SOC L1 fait principalement du triage."
    },
    {
      q: "Quelle est la difference entre un SOC L1, L2 et L3 ?",
      options: [
        "L1 = reponse, L2 = analyse, L3 = monitoring",
        "L1 = triage et monitoring, L2 = investigation approfondie, L3 = threat hunting et engineering",
        "L1 = management, L2 = technique, L3 = support",
        "Il n'y a pas de difference, les niveaux sont interchangeables"
      ],
      correct: 1,
      explanation: "L1 : monitoring, triage, escalade des alertes. L2 : investigation approfondie, analyse de malware basique, reponse a incident. L3 : threat hunting, ingenierie de detection, analyse forensique avancee, amelioration des processus."
    },
    {
      q: "Qu'est-ce que le MTTR et le MTTD dans un SOC ?",
      options: [
        "Des metriques de performance reseau",
        "MTTD = temps moyen de detection, MTTR = temps moyen de reponse/remediation",
        "Des standards de chiffrement",
        "Des niveaux de severite d'alerte"
      ],
      correct: 1,
      explanation: "MTTD (Mean Time to Detect) : temps moyen entre le debut d'un incident et sa detection. MTTR (Mean Time to Respond/Remediate) : temps moyen entre la detection et la resolution. Ces KPI mesurent l'efficacite du SOC."
    },
    {
      q: "EventCode 4672 dans Windows correspond a quoi ?",
      options: [
        "Echec de connexion",
        "Attribution de privileges speciaux a une session",
        "Creation de compte",
        "Modification du registre"
      ],
      correct: 1,
      explanation: "EventCode 4672 = Special Privileges Assigned to New Logon. Il indique qu'un utilisateur s'est connecte avec des privileges administratifs. Correle avec 4624, il permet d'identifier les connexions administratives."
    }
  ],

  // =========================================================================
  // MALWARE - Analyse, Detection, Threat Hunting
  // =========================================================================
  malware: [
    {
      q: "Qu'est-ce qu'un malware fileless ?",
      options: [
        "Un virus sans fichier sur disque qui opere en memoire",
        "Un malware tres petit en taille",
        "Un malware chiffre",
        "Un malware qui n'utilise pas le reseau"
      ],
      correct: 0,
      explanation: "Les fileless malwares operent uniquement en memoire, sans ecrire de fichiers sur le disque, utilisant des outils legitimes (PowerShell, WMI). Cela rend la detection par antivirus traditionnel tres difficile. Technique Living off the Land (LotL)."
    },
    {
      q: "Quel outil est le plus adapte pour l'analyse statique d'un fichier PE suspect ?",
      options: ["Wireshark", "PEStudio", "Process Monitor", "Nmap"],
      correct: 1,
      explanation: "PEStudio est l'outil de reference pour l'analyse statique de fichiers PE (Portable Executable). Il affiche les imports, exports, sections, entropie, strings, et indicateurs de malveillance sans executer le fichier."
    },
    {
      q: "Qu'est-ce que le 'beaconing' dans le contexte des RAT ?",
      options: [
        "Un type de scan reseau",
        "Des communications periodiques et regulieres entre le malware et le serveur C2",
        "Un protocole de chiffrement",
        "Une technique de propagation"
      ],
      correct: 1,
      explanation: "Le beaconing est le comportement d'un implant qui contacte regulierement son serveur C2 a intervalles fixes (avec un jitter pour eviter la detection). La detection se fait en analysant la periodicite des connexions sortantes."
    },
    {
      q: "Quel est le principal avantage d'une sandbox pour l'analyse de malware ?",
      options: [
        "Elle bloque automatiquement le malware",
        "Elle permet d'observer le comportement du malware en environnement isole et securise",
        "Elle genere des signatures antivirus",
        "Elle repare les fichiers infectes"
      ],
      correct: 1,
      explanation: "La sandbox permet d'executer le malware dans un environnement isole pour observer son comportement reel (fichiers crees, connexions reseau, modifications systeme) sans risque pour l'infrastructure de production."
    },
    {
      q: "Qu'est-ce que le 'packing' d'un malware ?",
      options: [
        "La compression et/ou chiffrement du code malveillant pour eviter la detection par signature",
        "L'envoi du malware par email",
        "La mise en paquet reseau du malware",
        "La documentation du malware"
      ],
      correct: 0,
      explanation: "Le packing est une technique d'obfuscation qui compresse et/ou chiffre le code du malware. Le code est decompresse en memoire a l'execution. Outils de detection : PEiD, Detect It Easy. Packers courants : UPX, Themida, VMProtect."
    },
    {
      q: "Quelle technique d'injection de processus consiste a creer un processus suspendu, vider sa memoire et y ecrire du code malveillant ?",
      options: ["DLL Injection", "Process Hollowing", "APC Injection", "Thread Hijacking"],
      correct: 1,
      explanation: "Le Process Hollowing (T1055.012) cree un processus legitime en etat suspendu, vide son code de la memoire (NtUnmapViewOfSection), ecrit le code malveillant a la place, puis le reprend. Le processus malveillant porte alors le nom d'un processus legitime."
    },
    {
      q: "Qu'est-ce qu'une regle YARA et a quoi sert-elle ?",
      options: [
        "Une regle de firewall pour bloquer le trafic malveillant",
        "Une regle de detection basee sur des patterns (strings et conditions) pour identifier des malwares",
        "Un protocole de communication entre serveurs",
        "Un standard de chiffrement pour les fichiers suspects"
      ],
      correct: 1,
      explanation: "YARA est un outil de detection et classification de malwares utilisant des regles textuelles. Chaque regle definit des chaines de caracteres (strings) et des conditions logiques pour identifier des fichiers ou processus malveillants."
    },
    {
      q: "Quel outil permet l'analyse de la memoire vive (RAM) pour la forensique ?",
      options: ["Wireshark", "Volatility", "Burp Suite", "Nessus"],
      correct: 1,
      explanation: "Volatility est le framework de reference pour l'analyse forensique de la memoire (memory forensics). Il permet d'analyser les processus, connexions reseau, DLL chargees, injections, et artefacts malveillants dans un dump memoire."
    },
    {
      q: "Qu'est-ce que le DNS tunneling ?",
      options: [
        "Un protocole DNS securise",
        "L'utilisation du protocole DNS pour exfiltrer des donnees ou etablir un canal C2 cache",
        "Un type de scan DNS",
        "La protection du serveur DNS contre les attaques"
      ],
      correct: 1,
      explanation: "Le DNS tunneling encode des donnees dans les requetes et reponses DNS (generalement dans les sous-domaines). Comme le DNS est rarement bloque, c'est un canal C2 furtif. Detection : sous-domaines longs, volume DNS eleve, entropie des requetes."
    },
    {
      q: "Quelle est la difference entre un Dropper et un Downloader ?",
      options: [
        "Il n'y a pas de difference",
        "Le Dropper contient le payload en lui-meme, le Downloader le telecharge depuis Internet",
        "Le Downloader est plus dangereux",
        "Le Dropper fonctionne uniquement sur Linux"
      ],
      correct: 1,
      explanation: "Un Dropper contient le payload malveillant integre (embedded) et le depose sur le systeme. Un Downloader telecharge le payload depuis un serveur distant (C2 ou CDN compromis). Le Downloader est plus flexible car le payload peut etre mis a jour."
    },
    {
      q: "Comment detecter une technique de persistance via les cles de registre Run ?",
      options: [
        "Surveiller les modifications des cles HKCU/HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
        "Analyser le trafic DNS",
        "Scanner les ports ouverts",
        "Verifier les certificats SSL"
      ],
      correct: 0,
      explanation: "Les cles Run et RunOnce dans le registre Windows sont un mecanisme de persistance classique (T1547.001). Surveiller avec Sysmon Event 13 (Registry Value Set) : EventCode=13 TargetObject=*CurrentVersion\\\\Run*"
    },
    {
      q: "Qu'est-ce que le 'Reflective DLL Injection' ?",
      options: [
        "Une injection de DLL standard via LoadLibrary",
        "Le chargement d'une DLL directement en memoire sans passer par les API Windows standard de chargement de fichiers",
        "La copie d'une DLL dans System32",
        "Un type de keylogger"
      ],
      correct: 1,
      explanation: "Le Reflective DLL Injection charge une DLL directement en memoire sans utiliser LoadLibrary, sans toucher le disque, et sans apparaitre dans les listes de modules charges. Utilise par Cobalt Strike, Meterpreter. Tres difficile a detecter."
    },
    {
      q: "Quel est le role de VirusTotal dans l'analyse de malware ?",
      options: [
        "Bloquer les virus en temps reel",
        "Analyser des fichiers, URL, IP et domaines avec plus de 70 moteurs antivirus et outils d'analyse",
        "Generer des signatures de malware",
        "Reparer les fichiers infectes"
      ],
      correct: 1,
      explanation: "VirusTotal est un service en ligne qui analyse les fichiers et URL soumis avec plus de 70 moteurs antivirus. Il fournit egalement des informations comportementales (sandbox), des IOC, et des relations entre echantillons. Attention : ne jamais soumettre de fichiers confidentiels."
    }
  ],

  // =========================================================================
  // HR - Questions comportementales et meta-questions d'entretien
  // =========================================================================
  hr: [
    {
      q: "Lors d'un entretien RH, quelle est la meilleure structure pour repondre a 'Parlez-moi d'un defi que vous avez surmonte' ?",
      options: ["Chronologique", "Methode STAR", "Thematique", "Liste de competences"],
      correct: 1,
      explanation: "La methode STAR (Situation, Tache, Action, Resultat) est la structure recommandee pour les questions comportementales. Elle permet de structurer une reponse concrete avec un contexte clair, les actions prises, et les resultats mesurables obtenus."
    },
    {
      q: "Comment repondre a 'Pourquoi voulez-vous travailler dans un SOC chez Sopra Steria ?' ?",
      options: [
        "Dire que le salaire est attractif",
        "Montrer sa passion pour la cybersecurite, lier ses competences aux besoins de l'entreprise, et mentionner les valeurs de Sopra Steria",
        "Dire que c'est le seul poste disponible",
        "Critiquer les autres entreprises du secteur"
      ],
      correct: 1,
      explanation: "Il faut montrer une motivation authentique : passion pour la cybersecurite defensive, interet pour les missions variees d'un SOC chez un grand acteur du numerique, volonte de monter en competence dans un environnement exigeant, et alignement avec les valeurs de l'entreprise."
    },
    {
      q: "Face a la question 'Quels sont vos points faibles ?', quelle est la meilleure approche ?",
      options: [
        "Dire qu'on n'a aucun point faible",
        "Mentionner un vrai point de progression avec les actions concretes mises en place pour s'ameliorer",
        "Donner un faux defaut deguise en qualite (perfectionniste)",
        "Lister tous ses defauts honntement"
      ],
      correct: 1,
      explanation: "La meilleure approche est d'etre authentique en mentionnant un vrai point de progression, tout en montrant la maturite et la proactivite par les actions concretes entreprises pour s'ameliorer. Cela demontre la capacite d'auto-evaluation."
    },
    {
      q: "Lors d'un entretien technique SOC, comment reagir si vous ne connaissez pas la reponse a une question ?",
      options: [
        "Inventer une reponse",
        "Admettre honntement qu'on ne sait pas, expliquer comment on rechercherait la reponse, et montrer sa capacite d'apprentissage",
        "Changer de sujet",
        "Dire que ce n'est pas important"
      ],
      correct: 1,
      explanation: "L'honntete intellectuelle est tres valorisee en cybersecurite. Admettre qu'on ne sait pas montre de l'integrite. Expliquer sa demarche de recherche (documentation, labs, communaute) montre la curiosite et la capacite d'apprentissage continue."
    },
    {
      q: "Quelle qualite est la plus importante pour un analyste SOC selon les recruteurs ?",
      options: [
        "Connaitre tous les outils du marche",
        "La curiosite, la rigueur et la capacite d'analyse methodique",
        "Avoir 10 ans d'experience",
        "Maitriser uniquement Splunk"
      ],
      correct: 1,
      explanation: "Les recruteurs valorisent la curiosite (envie d'apprendre, veille continue), la rigueur (documentation, methode), et l'esprit analytique (capacite a investiguer et correler). Les outils s'apprennent, le mindset est plus difficile a developper."
    },
    {
      q: "Comment mettre en valeur une reconversion professionnelle vers la cybersecurite ?",
      options: [
        "Ne pas en parler",
        "Presenter les competences transferables, la motivation de la reconversion, et les efforts d'autoformation realises",
        "Minimiser son experience precedente",
        "Dire que l'ancien metier n'avait aucun interet"
      ],
      correct: 1,
      explanation: "La reconversion est un atout si bien presentee : competences transferables (analyse, rigueur, communication), motivation forte et reflechie, autoformation demontree (labs, certifications, projets personnels). La diversite de profils enrichit les equipes SOC."
    },
    {
      q: "Comment repondre a la question 'Ou vous voyez-vous dans 5 ans ?' pour un poste SOC ?",
      options: [
        "A votre place (au manager)",
        "Presenter une evolution coherente : L1 vers L2/L3, specialisation en threat hunting ou forensique, ou evolution vers un role d'ingenieur detection",
        "Je ne sais pas du tout",
        "Dans une autre entreprise"
      ],
      correct: 1,
      explanation: "Montrer une vision claire et realiste d'evolution au sein du SOC : monter en competence technique (L2, L3), se specialiser (threat hunting, forensique, ingenierie de detection), obtenir des certifications (CySA+, GCIH, GCIA), et contribuer a l'amelioration continue des processus."
    },
    {
      q: "Qu'est-ce que Sopra Steria attend d'un candidat SOC en termes de soft skills ?",
      options: [
        "Uniquement des competences techniques",
        "Communication claire, travail en equipe, gestion du stress, documentation rigoureuse, et curiosite",
        "Leadership et management",
        "Competences commerciales"
      ],
      correct: 1,
      explanation: "Les soft skills essentiels en SOC : communication claire (escalade, rapports d'incidents), travail en equipe (SOC 24/7), gestion du stress (incidents critiques), documentation rigoureuse (tracabilite), curiosite (veille, apprentissage continu), et esprit critique (distinguer vrai/faux positif)."
    }
  ],

  // =========================================================================
  // FLASHCARDS - Revision rapide tous sujets
  // =========================================================================
  flashcards: [
    // --- Windows Event Codes ---
    { front: "EventCode 4624", back: "Connexion reussie Windows (Successful Logon). Types de logon importants : Type 2 (Interactif), Type 3 (Reseau), Type 10 (RDP)." },
    { front: "EventCode 4625", back: "Echec de connexion Windows (Failed Logon). Codes d'erreur : 0xC000006A = mauvais mot de passe, 0xC0000064 = compte inexistant, 0xC0000234 = compte verrouille." },
    { front: "EventCode 4634", back: "Fermeture de session (Logoff). Correle avec le 4624 via le Logon ID pour calculer la duree de session." },
    { front: "EventCode 4648", back: "Connexion avec des identifiants explicites (Explicit Credentials Logon). Peut indiquer l'utilisation de runas ou de mouvement lateral." },
    { front: "EventCode 4672", back: "Attribution de privileges speciaux a une nouvelle session (Special Privileges Assigned). Indique une connexion avec des droits administratifs." },
    { front: "EventCode 4688", back: "Creation d'un nouveau processus (Process Create). Necessite l'activation de l'audit avance pour capturer la ligne de commande." },
    { front: "EventCode 4720", back: "Creation d'un compte utilisateur (User Account Created). A surveiller pour detecter la creation de backdoor accounts." },
    { front: "EventCode 4722", back: "Activation d'un compte utilisateur (User Account Enabled). Peut indiquer la reactivation d'un compte precedemment desactive." },
    { front: "EventCode 4724", back: "Reinitialisation du mot de passe d'un compte par un administrateur (Password Reset). A correler avec l'identite de l'admin." },
    { front: "EventCode 4726", back: "Suppression d'un compte utilisateur (User Account Deleted). Peut indiquer un nettoyage post-compromission." },
    { front: "EventCode 4732", back: "Ajout d'un membre a un groupe local (Member Added to Local Group). Critique si le groupe est Administrateurs." },
    { front: "EventCode 7045", back: "Installation d'un nouveau service Windows (Service Installed). Indicateur de persistance. Verifier le chemin du binaire et le compte de service." },
    { front: "EventCode 1102", back: "Journal d'audit de securite efface (Security Audit Log Cleared). Indicateur majeur de Defense Evasion (T1070.001)." },
    { front: "EventCode 4697", back: "Installation d'un service (Security log). Similaire au 7045 mais dans le journal Security." },

    // --- Sysmon Event Codes ---
    { front: "Sysmon Event 1", back: "Creation de processus (Process Create). Capture Image, CommandLine, ParentImage, User, Hash. L'evenement Sysmon le plus important." },
    { front: "Sysmon Event 3", back: "Connexion reseau detectee (Network Connection). Capture le processus, IP/port source et destination. Utile pour detecter les C2." },
    { front: "Sysmon Event 7", back: "Chargement d'un module/DLL (Image Loaded). Permet de detecter les DLL malveillantes chargees par des processus legitimes." },
    { front: "Sysmon Event 8", back: "Creation d'un thread distant (CreateRemoteThread). Indicateur d'injection de processus (T1055)." },
    { front: "Sysmon Event 10", back: "Acces a un processus (Process Access). Crucial pour detecter l'acces a LSASS (credential dumping)." },
    { front: "Sysmon Event 11", back: "Creation de fichier (File Create). Permet de detecter le depot de malware sur le disque." },
    { front: "Sysmon Event 12/13/14", back: "Operations sur le registre : 12=Create/Delete key, 13=Value Set, 14=Rename. Critiques pour detecter la persistance." },
    { front: "Sysmon Event 17/18", back: "Named Pipe : 17=Pipe Created, 18=Pipe Connected. Les outils comme Cobalt Strike et PsExec utilisent des named pipes." },
    { front: "Sysmon Event 22", back: "Requete DNS (DNS Query). Capture les requetes DNS par processus. Utile pour detecter le DNS tunneling et les C2 DNS." },
    { front: "Sysmon Event 25", back: "Process Tampering (Image tampering). Detecte le process hollowing et le herpaderping." },

    // --- MITRE ATT&CK Techniques ---
    { front: "T1566", back: "Phishing (Initial Access). Sous-techniques : .001 Spearphishing Attachment, .002 Spearphishing Link, .003 Spearphishing via Service." },
    { front: "T1059", back: "Command and Scripting Interpreter (Execution). Sous-techniques : .001 PowerShell, .003 Windows Command Shell, .005 Visual Basic, .007 JavaScript." },
    { front: "T1078", back: "Valid Accounts (Initial Access / Persistence / Privilege Escalation / Defense Evasion). Utilisation de comptes legitimes compromis." },
    { front: "T1110", back: "Brute Force (Credential Access). Sous-techniques : .001 Password Guessing, .002 Password Cracking, .003 Password Spraying, .004 Credential Stuffing." },
    { front: "T1003", back: "OS Credential Dumping (Credential Access). Sous-techniques : .001 LSASS Memory (Mimikatz), .002 SAM, .003 NTDS, .006 DCSync." },
    { front: "T1486", back: "Data Encrypted for Impact (Impact). Technique principale des ransomwares. Chiffrement des fichiers pour extorsion." },
    { front: "T1055", back: "Process Injection (Defense Evasion / Privilege Escalation). DLL Injection, Process Hollowing, APC Injection, etc." },
    { front: "T1053", back: "Scheduled Task/Job (Execution / Persistence). Utilisation des taches planifiees pour executer du code et maintenir la persistance." },
    { front: "T1021", back: "Remote Services (Lateral Movement). Sous-techniques : .001 RDP, .002 SMB/Windows Admin Shares, .004 SSH, .006 WinRM." },
    { front: "T1047", back: "Windows Management Instrumentation - WMI (Execution). Execution de commandes via WMI. Detection : wmiprvse.exe creant des processus enfants." },
    { front: "T1218", back: "System Binary Proxy Execution (Defense Evasion). LOLBins : mshta, rundll32, regsvr32, certutil pour executer du code malveillant." },
    { front: "T1070", back: "Indicator Removal (Defense Evasion). Sous-techniques : .001 Clear Windows Event Logs, .003 Clear Command History, .004 File Deletion." },
    { front: "T1071", back: "Application Layer Protocol (C2). Communication C2 via HTTP/HTTPS (.001), DNS (.004), SMTP (.003) pour se fondre dans le trafic legitime." },
    { front: "T1547", back: "Boot or Logon Autostart Execution (Persistence). .001 Registry Run Keys, .004 Winlogon Helper DLL, .012 Print Processors." },
    { front: "T1190", back: "Exploit Public-Facing Application (Initial Access). Exploitation de vulnerabilites dans des applications exposees (web, VPN, etc.)." },
    { front: "T1027", back: "Obfuscated Files or Information (Defense Evasion). Obfuscation du code malveillant pour eviter la detection par signature." },

    // --- SPL Commands ---
    { front: "SPL: stats count by", back: "Agrege et compte les evenements groupes par un ou plusieurs champs. Ex: | stats count by src_ip, dest_port | sort -count" },
    { front: "SPL: timechart", back: "Cree un graphique temporel des evenements. Ex: | timechart span=1h count by sourcetype. Le temps est toujours l'axe X." },
    { front: "SPL: eval", back: "Cree ou modifie des champs avec des expressions calculees. Ex: | eval severity=if(count>100, \"critical\", \"low\")" },
    { front: "SPL: where", back: "Filtre les resultats avec une expression booleenne (sensible a la casse). Ex: | where status_code >= 400 AND user != \"admin\"" },
    { front: "SPL: lookup", back: "Enrichit les donnees avec une table de reference externe (CSV/KV Store). Ex: | lookup threat_intel ip as src_ip OUTPUT threat_category" },
    { front: "SPL: rex", back: "Extraction de champs via expressions regulieres. Ex: | rex field=_raw \"user=(?<username>\\w+)\" pour creer le champ username." },
    { front: "SPL: table", back: "Affiche uniquement les champs specifies en colonnes. Ex: | table _time, src_ip, dest_ip, action, user" },
    { front: "SPL: dedup", back: "Supprime les evenements en doublon bases sur un ou plusieurs champs. Ex: | dedup src_ip dest_ip garde une seule occurrence par paire." },
    { front: "SPL: transaction", back: "Groupe les evenements en transactions basees sur des champs communs et des contraintes temporelles. Ex: | transaction session_id maxspan=30m" },
    { front: "SPL: tstats", back: "Recherche acceleree sur les data models et index acceleres (tsidx). Beaucoup plus rapide que stats pour les grands volumes." },
    { front: "SPL: inputlookup", back: "Charge les donnees d'une lookup table comme source de recherche. Ex: | inputlookup threat_indicators.csv | search threat_type=\"malware\"" },
    { front: "SPL: append", back: "Ajoute les resultats d'une sous-recherche a la fin des resultats courants. Ex: search1 | append [search2]" },
    { front: "SPL: fillnull", back: "Remplace les valeurs null par une valeur specifiee. Ex: | fillnull value=0 count. Utile pour les graphiques et calculs." },
    { front: "SPL: rare", back: "Retourne les valeurs les moins frequentes d'un champ (inverse de top). Utile pour le threat hunting : | rare process_name" },
    { front: "SPL: eventstats", back: "Comme stats mais conserve tous les evenements originaux en ajoutant les champs calcules. Ex: | eventstats avg(bytes) as avg_bytes by host" },

    // --- Frameworks et Concepts ---
    { front: "NIST Phase 1", back: "Preparation : mise en place des outils, procedures, playbooks, formation des equipes, inventaire des assets, baseline du reseau." },
    { front: "NIST Phase 2", back: "Detection & Analyse : identification des incidents via SIEM/EDR/IDS, triage des alertes, analyse des IoC, evaluation de la severite et de l'impact." },
    { front: "NIST Phase 3", back: "Confinement, Eradication, Recuperation : isoler les systemes affectes, supprimer la menace, restaurer les services, verifier l'integrite." },
    { front: "NIST Phase 4", back: "Activite Post-Incident (Lessons Learned) : rapport d'incident, amelioration des detections, mise a jour des playbooks, partage des IOC." },
    { front: "IoC vs IoA", back: "IoC = preuve forensique d'une compromission passee (hash, IP, domaine). IoA = comportement suspect en cours independant des outils utilises (pattern d'activite)." },
    { front: "Kill Chain Phase 1", back: "Reconnaissance : collecte d'informations sur la cible (OSINT, scanning, enumeration). Active ou passive." },
    { front: "Kill Chain Phase 2", back: "Weaponization : creation de l'arme (exploit + payload). L'attaquant prepare le vecteur d'attaque (document piege, exploit kit)." },
    { front: "Kill Chain Phase 3", back: "Delivery : livraison de l'arme a la cible (email de phishing, drive-by download, USB, watering hole)." },
    { front: "Kill Chain Phase 4", back: "Exploitation : execution de l'exploit sur le systeme cible (vulnerabilite logicielle, macro, zero-day)." },
    { front: "Kill Chain Phase 5", back: "Installation : installation du malware/backdoor pour maintenir l'acces (persistance via registre, service, tache planifiee)." },
    { front: "Kill Chain Phase 6", back: "Command & Control (C2) : etablissement du canal de communication avec le serveur de l'attaquant (HTTP, DNS, HTTPS)." },
    { front: "Kill Chain Phase 7", back: "Actions on Objectives : l'attaquant atteint ses objectifs (exfiltration, chiffrement, sabotage, espionnage, mouvement lateral)." },
    { front: "Diamond Model", back: "Modele d'analyse d'intrusion avec 4 sommets : Adversary (qui), Capability (comment), Infrastructure (avec quoi), Victim (qui est cible). Chaque incident est un losange." },
    { front: "Pyramid of Pain", back: "Hierarchie de difficulte pour l'attaquant a changer ses indicateurs : Hash (trivial) < IP < Domaines < Artefacts reseau/host < Outils < TTPs (le plus difficile)." },
    { front: "STIX/TAXII", back: "STIX = format standardise pour decrire les menaces (IOC, TTPs, acteurs). TAXII = protocole de transport pour echanger des donnees STIX entre organisations." },
    { front: "CVE", back: "Common Vulnerabilities and Exposures : identifiant unique pour les vulnerabilites connues. Format : CVE-ANNEE-NUMERO. Gere par MITRE et la NVD du NIST." },
    { front: "CVSS", back: "Common Vulnerability Scoring System : score de severite d'une vulnerabilite de 0 a 10. Critique >= 9.0, Haute >= 7.0, Moyenne >= 4.0, Basse < 4.0." },
    { front: "TLP (Traffic Light Protocol)", back: "TLP RED = destinataires nommes uniquement. TLP AMBER = organisation + clients concernes. TLP GREEN = communaute. TLP CLEAR = public." },
    { front: "SOC L1 vs L2 vs L3", back: "L1 = Monitoring, triage, escalade. L2 = Investigation approfondie, IR, analyse de malware basique. L3 = Threat hunting, forensique avancee, ingenierie de detection." },
    { front: "EDR vs AV", back: "AV = detection par signature, prevention basique. EDR = detection comportementale, telemetrie des endpoints, investigation, reponse (isolation, remediation). L'EDR voit les actions, l'AV voit les fichiers." },
    { front: "XDR", back: "Extended Detection and Response : unifie la detection et la reponse sur plusieurs couches (endpoint, reseau, email, cloud, identite) dans une seule plateforme." },
    { front: "MISP", back: "Malware Information Sharing Platform : plateforme open source de partage d'IOC et de Threat Intelligence entre organisations. Permet la collaboration et l'enrichissement des detections." }
  ]
};

// ============================================================================
// Export pour utilisation dans l'application
// ============================================================================
if (typeof module !== 'undefined' && module.exports) {
  module.exports = { malwareData, quizData };
}
